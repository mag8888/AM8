/* Desktop: трехколоночная раскладка, поле по центру квадратом */
@media (min-width: 1025px) {
  .game-page {
    display: grid !important;
    /* Левая панель (карточки + банк): 320px, Центр (поле): 1fr, Правая панель (игроки): шире */
    grid-template-columns: 320px 1fr 450px !important;
    grid-template-rows: 1fr !important;
    grid-template-areas: "card-decks game-board players-panel" !important;
    gap: 1rem;
    align-items: stretch;
    justify-items: stretch;
    padding: 0.5rem !important;
    max-width: 1600px !important;
    margin: 0 auto !important;
    min-height: 100vh !important;
    height: auto !important;
    overflow: visible !important;
  }
  
  /* Левая панель: карточки сделок */
  #card-decks-panel.card-decks-container {
    grid-area: card-decks !important;
    display: flex !important;
    flex-direction: column !important;
    visibility: visible !important;
    opacity: 1 !important;
    min-width: 0 !important; /* Позволяет сжиматься в grid */
    max-width: 320px !important; /* Жесткое ограничение */
    width: 100% !important;
    min-height: 0 !important; /* Позволяет сжиматься в grid */
    height: auto !important;
    max-height: none !important;
    position: relative !important;
    transform: none !important;
    background: rgba(15, 23, 42, 0.95) !important;
    border-right: 2px solid rgba(148, 163, 184, 0.3) !important;
    padding: 1rem !important;
    box-sizing: border-box !important;
    z-index: 1 !important;
    overflow: visible !important;
    gap: 0.5rem !important;
  }
  
  /* Карточки сделок: компактные, чтобы все помещались */
  #card-decks-panel.card-decks-container .card-deck-card,
  #card-decks-panel .card-deck-card {
    flex: 0 0 auto !important; /* Не растягиваются */
    width: 100% !important;
    max-width: 100% !important; /* Не выходят за границы панели */
    min-width: 0 !important;
    padding: 0.5rem !important;
    box-sizing: border-box !important;
  }
  
  /* Заголовки/метрики в карточках — компактнее */
  #card-decks-panel .card-deck-title { 
    font-size: 0.95rem !important; 
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  #card-decks-panel .card-deck-subtitle { 
    font-size: 0.85rem !important; 
    overflow: hidden;
    text-overflow: ellipsis;
  }
  #card-decks-panel .deck-metric { 
    transform: scale(0.95); 
    transform-origin: left center; 
  }
  
  /* Центральная область: игровое поле */
  .game-board-container {
    grid-area: game-board !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    min-width: 0 !important; /* Позволяет сжиматься в grid */
    min-height: 0 !important;
    height: 100% !important;
    max-height: 100% !important;
    padding: 0.5rem !important;
    box-sizing: border-box !important;
    overflow: visible !important;
  }
  
  /* Квадратная доска по центру */
  .game-page .board-wrapper {
    width: min(90vmin, 90vw, 100%) !important;
    height: min(90vmin, 90vw, 100%) !important;
    aspect-ratio: 1 / 1 !important;
    margin: auto !important;
    max-width: 100% !important;
    max-height: 100% !important;
    min-height: 420px !important;
    box-sizing: border-box !important;
  }
  
  /* Правая панель: игроки (шире) */
  .top-panel-container {
    grid-area: players-panel !important;
    display: flex !important;
    flex-direction: column !important;
    visibility: visible !important;
    opacity: 1 !important;
    min-width: 0 !important; /* Позволяет сжиматься в grid */
    max-width: 450px !important; /* Увеличена ширина для карточек игроков */
    width: 100% !important;
    min-height: 0 !important;
    height: 100% !important;
    max-height: 100% !important;
    position: relative !important;
    transform: none !important;
    background: rgba(15, 23, 42, 0.95) !important;
    border-left: 2px solid rgba(148, 163, 184, 0.3) !important;
    padding: 1rem !important;
    box-sizing: border-box !important;
    z-index: 1 !important;
    overflow: visible !important;
  }
  
  .players-panel-container,
  #players-panel.top-panel-content {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    height: auto !important;
    flex: 1 1 auto !important;
    overflow: visible !important;
    gap: 1rem !important;
  }
  
  /* Секция действий на всю ширину */
  .actions-section,
  #players-panel .actions-section,
  .top-panel-content .actions-section {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }
  
  /* Кнопки действий на всю ширину */
  .actions-section .action-button,
  .actions-section button,
  .actions-section .btn {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
  
  /* Банк на десктопе: внутри левой панели (под карточками) */
  #card-decks-panel #bank-section {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin-top: auto !important; /* Прижимаем к низу */
    padding: 1rem 0 0 !important;
    box-sizing: border-box !important;
    border-top: 2px solid rgba(148, 163, 184, 0.3) !important;
    flex: 0 0 auto !important;
  }
  
  #bank-preview-container {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }
}

/* Mobile/tablet: вертикальная компоновка: игроки → поле → банк → колоды */
@media (max-width: 1024px) {
  /* Убираем все отступы у родительских контейнеров на мобиле */
  .app-content,
  #page-container,
  #game-page {
    padding: 0 !important;
    margin: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }
  
  .game-page {
    display: flex !important;
    flex-direction: column !important;
    height: auto !important;
    min-height: 100vh;
    overflow-y: auto !important; /* скролл всей страницы, включая поле */
    grid-template-columns: 1fr !important;
    grid-template-areas: none !important;
    padding: 0 !important; /* Убираем отступы для полной ширины */
    gap: 0 !important; /* Убираем gap для полной ширины */
    margin: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }
  
  /* Внутренние клетки на 15% меньше на мобиле */
  :root {
    --inner-cell-size: clamp(56px, 5.6vmin, 70px) !important; /* Уменьшено на 15% (было 66px, 6.6vmin, 82px) */
  }
  
  /* Верхняя панель: только игроки (банк будет после поля) - на всю ширину */
  .top-panel-container {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    min-width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    max-height: none !important;
    order: 1 !important;
    position: relative !important;
    transform: none !important;
    background: rgba(15, 23, 42, 0.95) !important;
    border-bottom: 2px solid rgba(148, 163, 184, 0.3) !important;
    border-left: none !important;
    border-right: none !important;
    padding: 1rem !important;
    margin: 0 !important;
    box-sizing: border-box !important;
    z-index: 0 !important;
    overflow: visible !important;
  }
  
  #players-panel.top-panel-content {
    display: flex !important;
    flex-direction: column !important; /* Вертикально на мобиле */
    width: 100% !important;
    min-width: 0 !important;
    height: auto !important;
    flex: 0 0 auto !important;
    overflow: visible !important;
    gap: 1rem !important;
    flex-wrap: nowrap !important;
  }
  
  /* Все секции внутри панели игроков на всю ширину */
  #players-panel > *,
  #players-list-container,
  .players-panel-container {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }
  
  /* Секции действий и игроков на всю ширину */
  .player-section,
  .actions-section,
  .players-section {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }
  
  /* Кнопки действий на всю ширину на мобиле */
  .action-button,
  .btn,
  button[class*="action"],
  .move-actions button,
  .status-actions button {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
  
  /* Контейнеры с кнопками на всю ширину */
  .move-actions,
  .status-actions,
  .game-controls {
    width: 100% !important;
    max-width: 100% !important;
    display: flex !important;
    flex-direction: column !important; /* Вертикально на мобиле */
    gap: 0.75rem !important;
    box-sizing: border-box !important;
  }
  
  /* Карточки игроков на всю ширину на мобиле */
  .players-panel-container .player-item,
  .player-item,
  .player-section,
  .player-card {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }
  
  .game-board-container {
    width: 100% !important;
    min-width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    min-height: 50vh;
    order: 2 !important;
    padding: 0 !important; /* Убираем отступы, соединяем с банком */
    margin: 0 !important;
    overflow: visible !important; /* не режем контент поля */
  }
  
  /* Банк на всю ширину, соединен с игровым полем, без дополнительного скролла */
  #card-decks-panel #bank-section {
    order: 1 !important; /* Банк первым внутри панели карточек на мобиле */
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    flex: 0 0 auto !important;
    margin-top: 0 !important;
    padding: 1rem !important;
    box-sizing: border-box !important;
    border-top: 2px solid rgba(148, 163, 184, 0.3) !important;
    border-bottom: 2px solid rgba(148, 163, 184, 0.3) !important;
    overflow: visible !important;
    background: rgba(15, 23, 42, 0.95) !important;
  }
  
  /* Карточки после банка на мобиле */
  #card-decks-panel .card-deck-card {
    order: 2 !important;
  }
  
  #bank-preview-container {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }
  
  #card-decks-panel.card-decks-container {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
    width: 100% !important;
    min-width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    max-height: none !important; /* Убираем внутренний скролл */
    order: 4 !important;
    border-right: none !important;
    border-left: none !important;
    border-bottom: none !important;
    padding: 1rem !important;
    position: relative !important;
    transform: none !important;
    flex-direction: column !important; /* Карточки в колонку */
    gap: 0.75rem !important;
    flex-wrap: nowrap !important;
    overflow-y: visible !important; /* Нет доп. скролла */
    overflow-x: hidden !important;
    background: rgba(15, 23, 42, 0.95) !important;
  }
  
  /* Карточки сделок на всю ширину */
  #card-decks-panel .card-deck-card,
  #card-decks-panel.card-decks-container .card-deck-card {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    flex: 0 0 auto !important;
  }
  
  /* Поле остаётся квадратом по ширине */
  .game-page .board-wrapper {
    width: 100% !important;
    max-width: 100vw !important;
    height: auto !important;
    aspect-ratio: 1 / 1 !important;
    margin: 0 auto !important;
    min-height: 320px !important; /* чёткий квадрат на маленьких экранах */
  }
}

